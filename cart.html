<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - VarnWear</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/user.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Dosis:wght@200..800&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
<style>
    .map {
      margin-top: 5px;
      height: 200px;
      width: 250px;
      overflow: hidden;
    }

    .social-icon i {
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.1);
     
      font-size: 20px;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .social-icon:hover i {
      transform: translateY(-3px) scale(1.1);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
    }


    .social-icon.twitter:hover i {
      background: #1da1f2;
      border-color: #1da1f2;
    }

    .social-icon.facebook:hover i {
      background: #4267b2;
      border-color: #4267b2;
    }

    .social-icon.instagram:hover i {
      background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
      border-color: #e6683c;
    }
</style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="navbar-brand">VarnWear</a>
            <ul class="navbar-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="products.html">Products</a></li>
                <li><a href="collections.html">Collections</a></li>
            </ul>
            <div class="navbar-right">
                <a href="login.html" class="btn btn-primary btn-small" id="loginBtn">Login</a>
                <div class="navbar-user" id="userSection" style="display: none;">
                    <div class="dropdown">
                        <div class="profile-icon" id="profileIcon">
                            <img id="profileImg" src="" alt="Profile" style="display: none;">
                            <span id="profileInitials"></span>
                        </div>
                        <div class="dropdown-menu" id="profileDropdown">
                            <a href="profile.html" class="dropdown-item">Profile</a>
                            <a href="orders.html" class="dropdown-item">Orders</a>
                            <a href="wishlist.html" class="dropdown-item">Wishlist</a>
                            <a href="contact.html" class="dropdown-item">Contact Us</a>
                            <a href="about.html" class="dropdown-item">About Us</a>
                            <a href="faq.html" class="dropdown-item">FAQ</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" id="logoutBtn">LogOut</a>
                        </div>
                    </div>
                    <a href="cart.html" class="cart-icon">
                        <span class="icon">üõí</span>
                        <span class="badge" id="cartCount">0</span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Cart Section -->
    <div class="container cart-container">
        <h1 class="mb-4">Shopping Cart</h1>

        <!-- Empty Cart Message -->
        <div id="emptyCart" style="display: none; text-align: center; padding: 4rem 0;">
            <h2>Your cart is empty</h2>
            <p style="color: var(--gray-dark); margin: 1rem 0;">Add some products to get started</p>
            <a href="products.html" class="btn btn-primary">Browse Products</a>
        </div>

        <!-- Cart Items -->
        <div id="cartContent" style="display: none;">
            <div class="cart-items" id="cartItems">
                <!-- Cart items will be rendered here -->
            </div>

            <!-- Cart Summary -->
            <div class="cart-summary">
                <h3 class="mb-3">Order Summary</h3>
                <div class="summary-row">
                    <span>Subtotal:</span>
                    <span id="subtotal">‚Çπ0</span>
                </div>
                <div class="summary-row">
                    <span>Shipping:</span>
                    <span id="shipping">‚Çπ0</span>
                </div>
                <div class="summary-row total">
                    <span>Total:</span>
                    <span id="total">‚Çπ0</span>
                </div>
                <button class="btn btn-primary btn-large mt-3" style="width: 100%;" onclick="proceedToCheckout()">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>VarnWear</h3>
          <p>üìç South 24 Parganas, West Bengal 700139</p>
          <p>üìû +91 98765 43210</p>
          <div class="map">
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14749.58389182888!2d88.13881518152233!3d22.451749504620924!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3a028797d22b3259%3A0x46cbffd9f0309f7e!2sDurgapur%2C%20West%20Bengal%20743318!5e0!3m2!1sen!2sin!4v1768406250026!5m2!1sen!2sin"
              width="400" height="300" style="border: 0" allowfullscreen="" loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>
        <div class="footer-section">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="products.html">Products</a></li>
            <li><a href="cart.html">Cart</a></li>
            <li><a href="wishlist.html">Wishlist</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="faq.html">FAQ</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Account</h3>
          <ul>
            <li><a href="login.html">Login</a></li>
            <li><a href="register.html">Register</a></li>
            <li><a href="orders.html">My Orders</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Social Links</h3>
          <ul style="display: flex; gap: 10px;">
            <li><a href="https://x.com/nexter_Sou" target="_blank" class="social-icon twitter">
                <i class="fab fa-twitter"></i>
              </a></li>
            <li><a href="https://www.facebook.com/soumya.biswas.940098" target="_blank" class="social-icon facebook">
                <i class="fab fa-facebook-f"></i>

              </a></li>
            <li><a href="https://www.instagram.com/soumyabrata__biswas" target="_blank" class="social-icon instagram">
                <i class="fab fa-instagram"></i>

              </a></li>
          </ul>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2026 VarnWear. All rights reserved.</p>
        </div>
      </div>
  </footer>
    <script src="js/api.js"></script>
  <script src="js/toast.js"></script>
    
    <script src="js/navbar.js"></script>
    
    <script src="js/cart.js"></script>
    <script>
        // Check authentication
        if (!requireAuth()) {
            // Will redirect to login
        }

        // Load cart on page load
        document.addEventListener('DOMContentLoaded', () => {
            displayCart();
        });

        // Display cart items
        async function displayCart() {
            const cart = await getCartWithDetails();
            const emptyCart = document.getElementById('emptyCart');
            const cartContent = document.getElementById('cartContent');
            const cartItems = document.getElementById('cartItems');

            if (cart.length === 0) {
                emptyCart.style.display = 'block';
                cartContent.style.display = 'none';
                return;
            }

            emptyCart.style.display = 'none';
            cartContent.style.display = 'block';

            // Render cart items
            cartItems.innerHTML = cart.map(item => {
                const product = item.product;
                const mainImage = product.images && product.images.length > 0 ? product.images[0] : 'assets/images/placeholder.jpg';
                const itemTotal = product.price * item.quantity;

                return `
                    <div class="cart-item">
                        <img src="${mainImage}" alt="${product.name}" class="cart-item-img">
                        <div class="cart-item-details">
                            <h3 class="cart-item-title">${product.name}</h3>
                            ${item.size ? `<p style="color: var(--gray-dark);">Size: ${item.size}</p>` : ''}
                            <p class="cart-item-price">‚Çπ${product.price.toLocaleString()}</p>
                            
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="updateQuantity('${product.id}', ${item.quantity - 1}, '${item.size || ''}')">-</button>
                                <span class="quantity-value">${item.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity('${product.id}', ${item.quantity + 1}, '${item.size || ''}')">+</button>
                                <span style="margin-left: 1rem; font-weight: 600;">Subtotal: ‚Çπ${itemTotal.toLocaleString()}</span>
                            </div>
                        </div>
                        <button class="remove-btn" onclick="removeItem('${product.id}', '${item.size || ''}')">Remove</button>
                    </div>
                `;
            }).join('');

            // Update summary
            updateSummary();
        }

        // Update quantity
        async function updateQuantity(productId, newQuantity, size) {
            const sizeValue = size === 'null' || size === '' ? null : size;
            
            if (newQuantity <= 0) {
                showConfirmModal(
                    'Remove Item',
                    'Remove this item from cart?',
                    () => {
                        removeFromCart(productId, sizeValue);
                        displayCart();
                        updateCartCount();
                        showToast('Item removed from cart', 'info');
                    }
                );
                return;
            }

            const result = await updateCartQuantity(productId, newQuantity, sizeValue);
            if (result) {
                displayCart();
                updateCartCount();
            }
        }

        // Remove item
        function removeItem(productId, size) {
            const sizeValue = size === 'null' || size === '' ? null : size;
            
            showConfirmModal(
                'Remove Item',
                'Remove this item from cart?',
                () => {
                    removeFromCart(productId, sizeValue);
                    displayCart();
                    updateCartCount();
                    showToast('Item removed from cart', 'info');
                }
            );
        }

        // Update summary
        async function updateSummary() {
            const subtotal = await getCartTotal();
            const shipping = subtotal > 0 ? (subtotal >= 2000 ? 0 : 100) : 0;
            const total = subtotal + shipping;

            document.getElementById('subtotal').textContent = `‚Çπ${subtotal.toLocaleString()}`;
            document.getElementById('shipping').textContent = shipping === 0 ? 'FREE' : `‚Çπ${shipping}`;
            document.getElementById('total').textContent = `‚Çπ${total.toLocaleString()}`;
        }

        // Proceed to checkout
        function proceedToCheckout() {
            window.location.href = 'checkout.html';
        }
    </script>
</body>
</html>
